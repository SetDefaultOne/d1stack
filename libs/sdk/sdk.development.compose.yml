name: "sdk"

services:
    lib-sdk:
        build:
            context: ../..
            dockerfile: ./libs/sdk/Dockerfile
            target: build
        volumes:
            - .:/app/libs/sdk
        command: npm run --workspace libs/sdk dev
        environment:
            CHOKIDAR_USEPOLLING: "true"
        depends_on:
            lib-sdk-build:
                condition: service_completed_successfully

    lib-sdk-build:
        build:
            context: ../..
            dockerfile: ./libs/sdk/Dockerfile
            target: build
        volumes:
            - .:/app/libs/sdk
        command: npm run --workspace libs/sdk build
